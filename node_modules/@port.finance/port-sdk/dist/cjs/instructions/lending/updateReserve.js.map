{"version":3,"file":"updateReserve.js","sourceRoot":"","sources":["../../../../src/instructions/lending/updateReserve.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,6CAIyB;AACzB,iDAAqD;AACrD,oEAAsD;AACtD,+CAAmD;AACnD,2DAAiE;AACjE,2DAA+E;AAC/E,+CAA+C;AAE/C,uDAAuD;AACvD,EAAE;AACF,yCAAyC;AACzC,EAAE;AACF,oCAAoC;AACpC,oCAAoC;AACpC,8CAA8C;AAC9C,wCAAwC;AACxC,yBAAyB;AACzB,8BAA8B;AACvB,MAAM,wBAAwB,GAAG,CACtC,MAAqB,EACrB,aAAwB,EAAE,IAAI;AAC9B,mBAA8B,EAAE,IAAI;AACpC,4BAAuC,EAAE,IAAI;AAC7C,wBAAmC,EAAE,IAAI;AACzC,mBAA8B,wBAAY,EAClB,EAAE;IAC1B,MAAM,UAAU,GAAG,YAAY,CAAC,MAAM,CAAC;QACrC,YAAY,CAAC,EAAE,CAAC,aAAa,CAAC;QAC9B,mCAAmC;QACnC,IAAA,iCAAmB,EAAC,QAAQ,CAAC;KAC9B,CAAC,CAAC;IACH,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IAC3C,UAAU,CAAC,MAAM,CACf;QACE,WAAW,EAAE,gCAAkB,CAAC,aAAa;QAC7C,MAAM;KACP,EACD,IAAI,CACL,CAAC;IACF,MAAM,IAAI,GAAG;QACX,IAAA,wBAAS,EAAC,aAAa,EAAE,yBAAU,CAAC,KAAK,CAAC;QAC1C,IAAA,wBAAS,EAAC,mBAAmB,EAAE,yBAAU,CAAC,IAAI,CAAC;QAC/C,IAAA,wBAAS,EAAC,4BAA4B,EAAE,yBAAU,CAAC,IAAI,CAAC;QACxD,IAAA,wBAAS,EAAC,wBAAwB,EAAE,yBAAU,CAAC,MAAM,CAAC;QACtD,IAAA,wBAAS,EAAC,4BAAkB,EAAE,yBAAU,CAAC,IAAI,CAAC;QAC9C,IAAA,wBAAS,EAAC,4BAAgB,EAAE,yBAAU,CAAC,IAAI,CAAC;KAC7C,CAAC;IAEF,OAAO,IAAI,gCAAsB,CAAC;QAChC,IAAI;QACJ,SAAS,EAAE,gBAAgB;QAC3B,IAAI;KACL,CAAC,CAAC;AACL,CAAC,CAAC;AAnCW,QAAA,wBAAwB,4BAmCnC","sourcesContent":["import {\n  PublicKey,\n  SYSVAR_RENT_PUBKEY,\n  TransactionInstruction,\n} from \"@solana/web3.js\";\nimport { TOKEN_PROGRAM_ID } from \"@solana/spl-token\";\nimport * as BufferLayout from \"@solana/buffer-layout\";\nimport { LendingInstruction } from \"./instruction\";\nimport { AccessType, getAccess } from \"../../utils/Instructions\";\nimport { ReserveConfig, ReserveConfigLayout } from \"../../structs/ReserveData\";\nimport { PORT_LENDING } from \"../../constants\";\n\n// Update configuration for an existing market reserve.\n//\n// Accounts expected by this instruction:\n//\n//   0. `[writable]` Reserve account\n//   1. `[]` Lending market account.\n//   2. `[]` Derived lending market authority.\n//   3. `[signer]` Lending market owner.\n//   4. `[]` Rent sysvar.\n//   5. `[]` Token program id.\nexport const updateReserveInstruction = (\n  config: ReserveConfig,\n  reservePubkey: PublicKey, // 0\n  lendingMarketPubkey: PublicKey, // 1\n  lendingMarketAuthorityPubkey: PublicKey, // 2\n  lendingMarketOwnerPubkey: PublicKey, // 3\n  lendingProgramId: PublicKey = PORT_LENDING\n): TransactionInstruction => {\n  const dataLayout = BufferLayout.struct([\n    BufferLayout.u8(\"instruction\"),\n    // eslint-disable-next-line new-cap\n    ReserveConfigLayout(\"config\"),\n  ]);\n  const data = Buffer.alloc(dataLayout.span);\n  dataLayout.encode(\n    {\n      instruction: LendingInstruction.UpdateReserve,\n      config,\n    },\n    data\n  );\n  const keys = [\n    getAccess(reservePubkey, AccessType.WRITE),\n    getAccess(lendingMarketPubkey, AccessType.READ),\n    getAccess(lendingMarketAuthorityPubkey, AccessType.READ),\n    getAccess(lendingMarketOwnerPubkey, AccessType.SIGNER),\n    getAccess(SYSVAR_RENT_PUBKEY, AccessType.READ),\n    getAccess(TOKEN_PROGRAM_ID, AccessType.READ),\n  ];\n\n  return new TransactionInstruction({\n    keys,\n    programId: lendingProgramId,\n    data,\n  });\n};\n"]}