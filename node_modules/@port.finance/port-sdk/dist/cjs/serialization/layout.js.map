{"version":3,"file":"layout.js","sourceRoot":"","sources":["../../../src/serialization/layout.ts"],"names":[],"mappings":"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","sourcesContent":["import { PublicKey } from \"@solana/web3.js\";\nimport * as BufferLayout from \"@solana/buffer-layout\";\nimport BN from \"bn.js\";\n\nexport const publicKey = (property: string): BufferLayout.Layout => {\n  const publicKeyLayout = BufferLayout.blob(\n    32,\n    property\n  ) as BufferLayout.Layout;\n\n  const _decode = publicKeyLayout.decode.bind(publicKeyLayout);\n  const _encode = publicKeyLayout.encode.bind(publicKeyLayout);\n\n  publicKeyLayout.decode = (buffer: Buffer, offset: number) => {\n    const data = _decode(buffer, offset);\n    return new PublicKey(data);\n  };\n\n  publicKeyLayout.encode = (key: PublicKey, buffer: Buffer, offset: number) => {\n    return _encode(key.toBuffer(), buffer, offset);\n  };\n\n  return publicKeyLayout;\n};\n\nexport const uint64 = (property = \"uint64\"): BufferLayout.Layout => {\n  return _uint(8, property);\n};\n\nexport const uint128 = (property = \"uint128\"): BufferLayout.Layout => {\n  return _uint(16, property);\n};\n\nconst _uint = (length: number, property: string): BufferLayout.Layout => {\n  const layout = BufferLayout.blob(length, property) as BufferLayout.Layout;\n\n  const _decode = layout.decode.bind(layout);\n  const _encode = layout.encode.bind(layout);\n\n  layout.decode = (buffer: Buffer, offset: number) => {\n    const data = _decode(buffer, offset);\n    return new BN(\n      [...data]\n        .reverse()\n        .map((i) => `00${i.toString(16)}`.slice(-2))\n        .join(\"\"),\n      16\n    );\n  };\n\n  layout.encode = (num: BN, buffer: Buffer, offset: number) => {\n    const a = num.toArray().reverse();\n    let b = Buffer.from(a);\n    if (b.length !== length) {\n      const zeroPad = Buffer.alloc(length);\n      b.copy(zeroPad);\n      b = zeroPad;\n    }\n\n    return _encode(b, buffer, offset);\n  };\n\n  return layout;\n};\n"]}