{"version":3,"file":"refreshReserve.js","sourceRoot":"","sources":["../../../../src/instructions/lending/refreshReserve.ts"],"names":[],"mappings":"AAAA,OAAO,EAEL,mBAAmB,EACnB,sBAAsB,GACvB,MAAM,iBAAiB,CAAC;AACzB,OAAO,KAAK,YAAY,MAAM,uBAAuB,CAAC;AACtD,OAAO,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAC;AAC/C,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,0BAA0B,CAAC;AACjE,OAAO,EAAE,kBAAkB,EAAE,MAAM,eAAe,CAAC;AAEnD,mBAAmB;AACnB,yBAAyB;AACzB,IAAI;AAEJ,MAAM,UAAU,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;AAEzE,qEAAqE;AACrE,EAAE;AACF,yCAAyC;AACzC,EAAE;AACF,qCAAqC;AACrC,0BAA0B;AAC1B,8CAA8C;AAC9C,uEAAuE;AACvE,MAAM,CAAC,MAAM,yBAAyB,GAAG,CACvC,OAAkB,EAClB,MAAwB,EACxB,mBAA8B,YAAY,EAClB,EAAE;IAC1B,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IAC3C,UAAU,CAAC,MAAM,CAAC,EAAE,WAAW,EAAE,kBAAkB,CAAC,cAAc,EAAE,EAAE,IAAI,CAAC,CAAC;IAE5E,MAAM,IAAI,GAAG;QACX,SAAS,CAAC,OAAO,EAAE,UAAU,CAAC,KAAK,CAAC;QACpC,SAAS,CAAC,mBAAmB,EAAE,UAAU,CAAC,IAAI,CAAC;KAChD,CAAC;IAEF,IAAI,MAAM,EAAE;QACV,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;KAC/C;IAED,OAAO,IAAI,sBAAsB,CAAC;QAChC,IAAI;QACJ,SAAS,EAAE,gBAAgB;QAC3B,IAAI;KACL,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import {\n  PublicKey,\n  SYSVAR_CLOCK_PUBKEY,\n  TransactionInstruction,\n} from \"@solana/web3.js\";\nimport * as BufferLayout from \"@solana/buffer-layout\";\nimport { PORT_LENDING } from \"../../constants\";\nimport { AccessType, getAccess } from \"../../utils/Instructions\";\nimport { LendingInstruction } from \"./instruction\";\n\n// interface Data {\n//   instruction: number;\n// }\n\nconst DataLayout = BufferLayout.struct([BufferLayout.u8(\"instruction\")]);\n\n// Accrue interest and update market price of liquidity on a reserve.\n//\n// Accounts expected by this instruction:\n//\n//   0. `[writable]` Reserve account.\n//   1. `[]` Clock sysvar.\n//   2. `[]` Reserve liquidity oracle account.\n//             Must be the Pyth price account specified at InitReserve.\nexport const refreshReserveInstruction = (\n  reserve: PublicKey,\n  oracle: PublicKey | null,\n  lendingProgramId: PublicKey = PORT_LENDING\n): TransactionInstruction => {\n  const data = Buffer.alloc(DataLayout.span);\n  DataLayout.encode({ instruction: LendingInstruction.RefreshReserve }, data);\n\n  const keys = [\n    getAccess(reserve, AccessType.WRITE),\n    getAccess(SYSVAR_CLOCK_PUBKEY, AccessType.READ),\n  ];\n\n  if (oracle) {\n    keys.push(getAccess(oracle, AccessType.READ));\n  }\n\n  return new TransactionInstruction({\n    keys,\n    programId: lendingProgramId,\n    data,\n  });\n};\n"]}