"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.aprToApy = exports.getAprInfo = exports.getAmountByDecimals = void 0;
const anchor_1 = require("@project-serum/anchor");
const bignumber_js_1 = require("bignumber.js");
function getAmountByDecimals(amount = new anchor_1.BN(0), decimals) {
    return new bignumber_js_1.default(amount.toString()).dividedBy(new bignumber_js_1.default(Math.pow(10, decimals))).toNumber();
}
exports.getAmountByDecimals = getAmountByDecimals;
function getAprInfo(utilization, config) {
    const { threshold1, threshold2, base1, factor1, base2, factor2, base3, factor3 } = config;
    let borrowInterest = 0;
    if (utilization > 0 && utilization <= threshold1 / 100) {
        borrowInterest = base1 / 100 + (factor1 / 100 * utilization);
    }
    else if (utilization > threshold1 / 100 && utilization <= threshold2 / 100) {
        borrowInterest = base2 / 100 + (factor2 / 100 * (utilization - threshold1 / 100));
    }
    else if (utilization > threshold2 / 100) {
        borrowInterest = base3 / 100 + (factor3 / 100 * (utilization - threshold2 / 100));
    }
    const apr = utilization * borrowInterest * 100;
    const apy = aprToApy(apr / 100) * 100;
    return {
        borrowInterest: borrowInterest * 100,
        apr,
        apy
    };
}
exports.getAprInfo = getAprInfo;
function aprToApy(apr, n = 365) {
    return Math.pow((1 + apr / n), n) - 1;
}
exports.aprToApy = aprToApy;
